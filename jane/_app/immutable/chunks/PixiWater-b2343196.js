import{W as _,X as C,Y as E,U as k,S as v,i as D,s as j,k as I,l as T,m as O,h as b,n as x,b as W,L as q,A as P,J as M,o as F,K as N}from"./index-5319765f.js";import{A as R,S,W as z,f as J,C as K}from"./_page-bd2b2440.js";import{b as L}from"./paths-e0f500b8.js";import{w as U}from"./index-bdd711d3.js";import{s as V}from"./index-26e09f74.js";function A(e){return Object.prototype.toString.call(e)==="[object Date]"}function h(e,t){if(e===t||e!==e)return()=>e;const s=typeof e;if(s!==typeof t||Array.isArray(e)!==Array.isArray(t))throw new Error("Cannot interpolate values of different type");if(Array.isArray(e)){const n=t.map((a,r)=>h(e[r],a));return a=>n.map(r=>r(a))}if(s==="object"){if(!e||!t)throw new Error("Object cannot be null");if(A(e)&&A(t)){e=e.getTime(),t=t.getTime();const r=t-e;return i=>new Date(e+i*r)}const n=Object.keys(t),a={};return n.forEach(r=>{a[r]=h(e[r],t[r])}),r=>{const i={};return n.forEach(c=>{i[c]=a[c](r)}),i}}if(s==="number"){const n=t-e;return a=>e+a*n}throw new Error(`Cannot interpolate ${s} values`)}function X(e,t={}){const s=U(e);let n,a=e;function r(i,c){if(e==null)return s.set(e=i),Promise.resolve();a=i;let o=n,d=!1,{delay:u=0,duration:f=400,easing:l=k,interpolate:p=h}=_(_({},t),c);if(f===0)return o&&(o.abort(),o=null),s.set(e=a),Promise.resolve();const m=C()+u;let y;return n=E(g=>{if(g<m)return!0;d||(y=p(e,i),typeof f=="function"&&(f=f(e,i)),d=!0),o&&(o.abort(),o=null);const w=g-m;return w>f?(s.set(e=i),!1):(s.set(e=y(l(w/f))),!0)}),n.promise}return{set:r,update:(i,c)=>r(i(a,e),c),subscribe:s.subscribe}}function Y(e){let t,s,n,a;return{c(){t=I("div"),this.h()},l(r){t=T(r,"DIV",{class:!0}),O(t).forEach(b),this.h()},h(){x(t,"class",s=e[0]+" pixi-canvas svelte-1k5qfmg")},m(r,i){W(r,t,i),n||(a=q(t,"click",e[5]),n=!0)},p(r,[i]){i&1&&s!==(s=r[0]+" pixi-canvas svelte-1k5qfmg")&&x(t,"class",s)},i:P,o:P,d(r){r&&b(t),n=!1,a()}}}function B(e,t,s){let n,{imageSrc:a}=t,{displacePower:r=20}=t,{canvasId:i}=t;const c=new R({resizeTo:document.body}),o=S.from(`${L}/img/displacement_map.jpeg`);o.texture.baseTexture.wrapMode=z.REPEAT;const d=new J.DisplacementFilter(o),u=X(0,{duration:600,easing:V});M(e,u,l=>s(4,n=l)),F(()=>{document.querySelector(`.${i}`).appendChild(c.view),c.stage.interactive=!0;const p=new K;c.stage.addChild(p);const m=S.from(a);return p.addChild(m),c.stage.addChild(o),m.filters=[d],d.padding=10,d.scale.x=r,d.scale.y=r,c.ticker.add(()=>{o.x++,o.x>o.width&&(o.x=0)}),()=>{c.destroy(!0)}});function f(l){N.call(this,e,l)}return e.$$set=l=>{"imageSrc"in l&&s(2,a=l.imageSrc),"displacePower"in l&&s(3,r=l.displacePower),"canvasId"in l&&s(0,i=l.canvasId)},e.$$.update=()=>{e.$$.dirty&8&&u.set(r),e.$$.dirty&16&&(d.scale.x=n,d.scale.y=n)},[i,u,a,r,n,f]}class ee extends v{constructor(t){super(),D(this,t,B,Y,j,{imageSrc:2,displacePower:3,canvasId:0})}}export{ee as default};
