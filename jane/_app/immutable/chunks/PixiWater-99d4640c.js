import{X as b,Y as T,Z as C,O as E,S as W,i as k,s as v,k as D,l as j,m as I,h as P,n as w,b as O,N as q,A as S,J as G,o as M,P as N}from"./index-2e6c980c.js";import{A as F,S as x,W as R,f as z,C as H}from"./pixi-7ebbcd1d.js";import{b as J}from"./paths-e0f500b8.js";import{w as V}from"./index-38cd9857.js";import{s as X}from"./PixiWaterAsync-543208db.js";function A(e){return Object.prototype.toString.call(e)==="[object Date]"}function g(e,t){if(e===t||e!==e)return()=>e;const s=typeof e;if(s!==typeof t||Array.isArray(e)!==Array.isArray(t))throw new Error("Cannot interpolate values of different type");if(Array.isArray(e)){const n=t.map((a,r)=>g(e[r],a));return a=>n.map(r=>r(a))}if(s==="object"){if(!e||!t)throw new Error("Object cannot be null");if(A(e)&&A(t)){e=e.getTime(),t=t.getTime();const r=t-e;return i=>new Date(e+i*r)}const n=Object.keys(t),a={};return n.forEach(r=>{a[r]=g(e[r],t[r])}),r=>{const i={};return n.forEach(c=>{i[c]=a[c](r)}),i}}if(s==="number"){const n=t-e;return a=>e+a*n}throw new Error(`Cannot interpolate ${s} values`)}function Y(e,t={}){const s=V(e);let n,a=e;function r(i,c){if(e==null)return s.set(e=i),Promise.resolve();a=i;let d=n,f=!1,{delay:u=0,duration:l=400,easing:y=E,interpolate:h=g}=b(b({},t),c);if(l===0)return d&&(d.abort(),d=null),s.set(e=a),Promise.resolve();const o=T()+u;let p;return n=C(m=>{if(m<o)return!0;f||(p=h(e,i),typeof l=="function"&&(l=l(e,i)),f=!0),d&&(d.abort(),d=null);const _=m-o;return _>l?(s.set(e=i),!1):(s.set(e=p(y(_/l))),!0)}),n.promise}return{set:r,update:(i,c)=>r(i(a,e),c),subscribe:s.subscribe}}function Z(e){let t,s,n,a,r;return{c(){t=D("div"),this.h()},l(i){t=j(i,"DIV",{class:!0,style:!0}),I(t).forEach(P),this.h()},h(){w(t,"class",s=e[0]+" pixi-canvas svelte-1k5qfmg"),w(t,"style",n=e[1]?"filter: grayscale();":void 0)},m(i,c){O(i,t,c),a||(r=q(t,"click",e[7]),a=!0)},p(i,[c]){c&1&&s!==(s=i[0]+" pixi-canvas svelte-1k5qfmg")&&w(t,"class",s),c&2&&n!==(n=i[1]?"filter: grayscale();":void 0)&&w(t,"style",n)},i:S,o:S,d(i){i&&P(t),a=!1,r()}}}function B(e,t,s){let n,{imageSrc:a}=t,{displacePower:r=20}=t,{canvasId:i}=t,{isGrayscale:c=!1}=t,{fitToWindow:d=!1}=t;const f=new F({resizeTo:document.body}),u=x.from(`${J}/img/displacement_map.jpeg`);u.texture.baseTexture.wrapMode=R.REPEAT;const l=new z.DisplacementFilter(u),y=Y(0,{duration:600,easing:X});G(e,y,o=>s(6,n=o)),M(()=>{document.querySelector(`.${i}`).appendChild(f.view),f.stage.interactive=!0;const p=new H;f.stage.addChild(p);const m=x.from(a);return d&&(m.width=window.innerWidth,m.height=window.innerHeight),p.addChild(m),f.stage.addChild(u),m.filters=[l],l.padding=10,l.scale.x=r,l.scale.y=r,f.ticker.add(()=>{u.x++,u.x>u.width&&(u.x=0)}),()=>{f.destroy(!0)}});function h(o){N.call(this,e,o)}return e.$$set=o=>{"imageSrc"in o&&s(3,a=o.imageSrc),"displacePower"in o&&s(4,r=o.displacePower),"canvasId"in o&&s(0,i=o.canvasId),"isGrayscale"in o&&s(1,c=o.isGrayscale),"fitToWindow"in o&&s(5,d=o.fitToWindow)},e.$$.update=()=>{e.$$.dirty&16&&y.set(r),e.$$.dirty&64&&(l.scale.x=n,l.scale.y=n)},[i,c,y,a,r,d,n,h]}class ee extends W{constructor(t){super(),k(this,t,B,Z,v,{imageSrc:3,displacePower:4,canvasId:0,isGrayscale:1,fitToWindow:5})}}export{ee as default};
